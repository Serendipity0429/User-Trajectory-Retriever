<div class="card shadow-sm mb-4">
    <div class="card-header" data-bs-toggle="collapse" data-bs-target="#searchSettingsContent" style="cursor: pointer;">
        <h5 class="mb-0"><i class="bi bi-search me-2"></i>Search Configuration</h5>
    </div>
    <div class="collapse" id="searchSettingsContent">
        <div class="card-body">
            <div class="mb-3">
                <label for="search_provider" class="form-label">Search Provider</label>
                <select class="form-select" id="search_provider">
                    <option value="mcp" {% if search_settings.search_provider == 'mcp' %}selected{% endif %}>MCP Server (Default)</option>
                    <option value="serper" {% if search_settings.search_provider == 'serper' %}selected{% endif %}>Serper API</option>
                </select>
                <div class="form-text">Select the search backend for the RAG pipeline.</div>
            </div>
            <div class="mb-3" id="serper_api_key_container" style="{% if search_settings.search_provider != 'serper' %}display: none;{% endif %}">
                <label for="serper_api_key" class="form-label">Serper API Key</label>
                <div class="input-group mb-3">
                    <span class="input-group-text"><i class="bi bi-key"></i></span>
                    <input type="password" class="form-control" id="serper_api_key" value="{{ search_settings.serper_api_key }}" placeholder="Enter Serper API Key">
                    <button class="btn btn-outline-secondary" type="button" id="toggle-serper-key-visibility">
                        <i class="bi bi-eye"></i>
                    </button>
                </div>
                
                <div class="form-check form-switch">
                    <input class="form-check-input" type="checkbox" role="switch" id="serper_fetch_full_content" {% if search_settings.serper_fetch_full_content %}checked{% endif %}>
                    <label class="form-check-label" for="serper_fetch_full_content">Fetch Full Page Content</label>
                    <div class="form-text small text-muted">If enabled, the system will visit the result pages to extract full text (slower but more detailed). Otherwise, it uses snippets.</div>
                </div>
            </div>
            <div class="d-flex justify-content-end">
                <button type="button" id="save-search-settings-btn" class="btn btn-primary">
                    <i class="bi bi-save me-1"></i>Save Search Settings
                </button>
            </div>
        </div>
    </div>
</div>
