{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}THUIR Annotation Platform{% endblock %}</title>
    <link rel="icon" href="{% static 'img/IR4.png' %}" type="image/png"/>

    <!-- Font Awesome -->
    <link href="{% static 'css/vendor/fontawesome.min.css' %}" rel="stylesheet">

    <!-- Modern Bootstrap 5 -->
    <link href="{% static 'css/vendor/bootstrap.min.css' %}" rel="stylesheet">
    
    <!-- Google Fonts Alternative (Noto Sans) -->
    <link href="{% static 'css/vendor/noto-sans.css' %}" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="{% static 'css/custom.css' %}" rel="stylesheet">
    <link href="{% static 'css/vendor/bootstrap-icons.css' %}" rel="stylesheet">
    <link href="{% static 'css/rrweb-player.css' %}" rel="stylesheet"/>
    <link href="{% static 'css/dark.css' %}" rel="stylesheet">
    <link href="{% static 'css/custom_bootstrap_overrides.css' %}" rel="stylesheet">

    <style>
        .option-number {
            display: inline-block;
            width: 20px; /* Adjust as needed */
            text-align: right;
            margin-right: 10px; /* Space between number and text */
            font-weight: bold;
        }
        .option-text {
            display: inline-block;
        }
    </style>

    <script>
        // Apply dark mode immediately to prevent flickering
        (function() {
            if (localStorage.getItem('darkMode') === 'enabled') {
                document.documentElement.classList.add('dark-mode');
            }
        })();
    </script>

    {% block css %}{% endblock %}
    <script src="{% static 'js/rrweb-player.js' %}"></script>
    {% block head %}{% endblock %}
</head>
<body>
    <div class="wrapper">
        <!-- Sidebar -->
        <nav id="sidebar" class="bg-dark active">
            <div class="sidebar-header">
                <h2>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <img src="{% static 'img/IR4.png' %}" alt="Logo" style="width: 40px; height: 40px;">
                        <span style="letter-spacing: 4px; font-weight: bold;">THUIR</span>
                    </div>
                    <div style="text-align: right; letter-spacing: 4px; font-weight: bold;">
                        Annotation
                    </div>
                    <div style="text-align: right; letter-spacing: 4px; font-weight: bold;">
                        Platform
                    </div>
                </h2>
            </div>

            <hr style="border-color: #6c757d; width: 80%; margin: 5px auto;">

            <ul class="list-unstyled components">
                <li class="active">
                    <a href="/"><i class="bi bi-house-door-fill"></i> Home</a>
                </li>
                <li>
                    <a href="/user/info"><i class="bi bi-person-circle"></i> User Info</a>
                </li>
                {% if user.is_superuser %}
                <li>
                    <a href="{% url 'user_system:admin_page' %}"><i class="bi bi-person-badge-fill"></i> Admin Page</a>
                </li>
                {% endif %}
                {% if user.is_authenticated %}
                <li>
                    <a href="{% url 'user_system:logout' %}" onclick="return confirm('Are you sure you want to log out?');"><i class="bi bi-box-arrow-right"></i> Log out</a>
                </li>
                {% else %}
                <li>
                    <a href="{% url 'user_system:login' %}"><i class="bi bi-box-arrow-in-right"></i> Log in</a>
                </li>
                {% endif %}
            </ul>
        </nav>

        <!-- Page Content -->
        <div id="content">
            <header class="sticky-top">
                <nav class="navbar navbar-expand-lg navbar-light bg-light">
                    <div class="container-fluid">
                        <button type="button" id="sidebarCollapse">
                            <span>Toggle Sidebar</span>
                            <i class="bi bi-chevron-right"></i>
                        </button>
                        <div class="form-check form-switch ms-auto">
                            <input class="form-check-input" type="checkbox" id="darkModeSwitch">
                            <label class="form-check-label" for="darkModeSwitch">Dark Mode</label>
                        </div>
                    </div>
                </nav>
            </header>

            <main class="container-fluid my-4">
                {% block content %}
                {% endblock %}
            </main>

            <footer class="footer mt-auto py-3 bg-light">
                <div class="container text-center">
                    <span class="text-muted">&copy; 2025 THUIR. All Rights Reserved.</span>
                </div>
            </footer>
        </div>
    </div>

    <!-- Bootstrap 5 JS -->
    <script src="{% static 'js/vendor/bootstrap.bundle.min.js' %}"></script>
    
    <!-- jQuery -->
    <script src="{% static 'js/vendor/jquery-3.6.0.min.js' %}"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            $('#sidebarCollapse').on('click', function () {
                $('#sidebar').toggleClass('active');
                $(this).find('i').toggleClass('bi-chevron-right bi-chevron-left');
            });

            // Dark Mode Switcher
            const darkModeSwitch = document.getElementById('darkModeSwitch');
            const rootElement = document.documentElement;

            // Set the switch to the correct state on page load
            if (localStorage.getItem('darkMode') === 'enabled') {
                darkModeSwitch.checked = true;
            }

            darkModeSwitch.addEventListener('change', () => {
                if (darkModeSwitch.checked) {
                    rootElement.classList.add('dark-mode');
                    localStorage.setItem('darkMode', 'enabled');
                } else {
                    rootElement.classList.remove('dark-mode');
                    localStorage.setItem('darkMode', 'disabled');
                }
            });

            // Handle floating labels for select elements
            function updateUserInterface() {
                document.querySelectorAll('.form-select').forEach(function(select) {
                    if (select.value) {
                        select.classList.add('has-value');
                    } else {
                        select.classList.remove('has-value');
                    }
                });
            }

            document.addEventListener('DOMContentLoaded', updateUserInterface);

            document.querySelectorAll('.form-select').forEach(function(select) {
                select.addEventListener('change', function() {
                    if (this.value) {
                        this.classList.add('has-value');
                    } else {
                        this.classList.remove('has-value');
                    }
                });
            });
        });
    </script>

    {% block scripts %}{% endblock %}
</body>
</html>