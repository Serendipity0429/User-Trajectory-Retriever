{% extends "base.html" %}
{% block title %}Sign Up{% endblock %}

{% block content %}
<div class="container">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card shadow-lg border-0 rounded-lg mt-5">
                <div class="card-header text-center py-4 bg-primary text-white">
                    <h3 class="fw-light my-2">Create a New Account</h3>
                </div>
                <div class="card-body p-5">
                    {% if form.non_field_errors %}
                        <div class="alert alert-danger">
                            {% for error in form.non_field_errors %}
                                <p>{{ error }}</p>
                            {% endfor %}
                        </div>
                    {% endif %}
                    <form id="signup_form" name="signup_form" action="" method="POST" novalidate>
                        {% csrf_token %}

                        <h5 class="mb-4"><i class="bi bi-person-badge-fill me-2"></i>Account Information</h5>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <div class="form-floating">
                                    <input type="text" name="username" class="form-control {% if form.username.errors %}is-invalid{% endif %}" id="id_username" placeholder="Username" value="{{ form.username.value|default_if_none:'' }}">
                                    <label for="id_username"><i class="bi bi-person-fill me-2"></i>Username</label>
                                    {% if form.username.errors %}
                                        <div class="invalid-feedback">
                                            {{ form.username.errors.as_text }}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="form-floating">
                                    <input type="text" name="name" class="form-control {% if form.name.errors %}is-invalid{% endif %}" id="id_name" placeholder="Name" value="{{ form.name.value|default_if_none:'' }}">
                                    <label for="id_name"><i class="bi bi-person-circle me-2"></i>Name</label>
                                    {% if form.name.errors %}
                                        <div class="invalid-feedback">
                                            {{ form.name.errors.as_text }}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="form-floating position-relative">
                                    <input type="password" name="password" class="form-control {% if form.password.errors %}is-invalid{% endif %}" id="id_password" placeholder="Password" value="{{ form.password.value|default_if_none:'' }}">
                                    <label for="id_password"><i class="bi bi-key-fill me-2"></i>Password</label>
                                    <i class="bi bi-eye-slash position-absolute top-50 end-0 translate-middle-y me-3" id="togglePassword" style="cursor: pointer;"></i>
                                    {% if form.password.errors %}
                                        <div class="invalid-feedback">
                                            {{ form.password.errors.as_text }}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="form-floating position-relative">
                                    <input type="password" name="password_retype" class="form-control {% if form.password_retype.errors %}is-invalid{% endif %}" id="id_password_retype" placeholder="Retype Password" value="{{ form.password_retype.value|default_if_none:'' }}">
                                    <label for="id_password_retype"><i class="bi bi-key me-2"></i>Retype Password</label>
                                    <i class="bi bi-eye-slash position-absolute top-50 end-0 translate-middle-y me-3" id="togglePasswordRetype" style="cursor: pointer;"></i>
                                    {% if form.password_retype.errors %}
                                        <div class="invalid-feedback">
                                            {{ form.password_retype.errors.as_text }}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12 text-center">
                                <div class="form-text text-muted small">
                                    *Your password is securely encrypted with one-way hashing and <strong>cannot be decrypted by anyone, including us.</strong> For details, please click <a class="text-decoration-underline" href="https://docs.djangoproject.com/en/5.2/topics/auth/passwords/">here</a>.
                                </div>
                            </div>
                        </div>

                        <hr class="my-4">

                        <h5 class="mb-4"><i class="bi bi-file-person-fill me-2"></i>Personal Details</h5>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <div class="form-floating">
                                    {{ form.email }}
                                    <label for="id_email"><i class="bi bi-envelope-fill me-2"></i>Email</label>
                                    {% if form.email.errors %}
                                        <div class="invalid-feedback">
                                            {{ form.email.errors.as_text }}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="form-floating">
                                    <input type="text" name="phone" class="form-control {% if form.phone.errors %}is-invalid{% endif %}" id="id_phone" placeholder="Phone" value="{{ form.phone.value|default_if_none:'' }}">
                                    <label for="id_phone"><i class="bi bi-telephone-fill me-2"></i>Phone</label>
                                    {% if form.phone.errors %}
                                        <div class="invalid-feedback">
                                            {{ form.phone.errors.as_text }}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <div class="form-floating">
                                    <select name="gender" class="form-select {% if form.gender.errors %}is-invalid{% endif %}" id="id_gender">
                                        {% for value, text in form.fields.gender.choices %}
                                            <option value="{{ value }}" {% if form.gender.value == value %}selected{% endif %}>{{ text }}</option>
                                        {% endfor %}
                                    </select>
                                    <label for="id_gender"><i class="bi bi-gender-ambiguous me-2"></i>Gender</label>
                                    {% if form.gender.errors %}
                                        <div class="invalid-feedback">
                                            {{ form.gender.errors.as_text }}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <div class="form-floating">
                                    <input type="number" name="age" class="form-control {% if form.age.errors %}is-invalid{% endif %}" id="id_age" value="{{ form.age.value|default_if_none:'' }}">
                                    <label for="id_age"><i class="bi bi-calendar-event-fill me-2"></i>Age</label>
                                    {% if form.age.errors %}
                                        <div class="invalid-feedback">
                                            {{ form.age.errors.as_text }}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <div class="form-floating">
                                    <select name="occupation" class="form-select {% if form.occupation.errors %}is-invalid{% endif %}" id="id_occupation">
                                        {% for value, text in form.fields.occupation.choices %}
                                            <option value="{{ value }}" {% if form.occupation.value == value %}selected{% endif %}>{{ text }}</option>
                                        {% endfor %}
                                    </select>
                                    <label for="id_occupation"><i class="bi bi-briefcase-fill me-2"></i>Occupation</label>
                                    {% if form.occupation.errors %}
                                        <div class="invalid-feedback">
                                            {{ form.occupation.errors.as_text }}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <div class="form-floating">
                                    <select name="education" class="form-select {% if form.education.errors %}is-invalid{% endif %}" id="id_education">
                                        {% for value, text in form.fields.education.choices %}
                                            <option value="{{ value }}" {% if form.education.value == value %}selected{% endif %}>{{ text }}</option>
                                        {% endfor %}
                                    </select>
                                    <label for="id_education"><i class="bi bi-book-fill me-2"></i>Education Level</label>
                                    {% if form.education.errors %}
                                        <div class="invalid-feedback">
                                            {{ form.education.errors.as_text }}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="form-floating">
                                    <input type="text" name="field_of_expertise" class="form-control {% if form.field_of_expertise.errors %}is-invalid{% endif %}" id="id_field_of_expertise" value="{{ form.field_of_expertise.value|default_if_none:'' }}">
                                    <label for="id_field_of_expertise"><i class="bi bi-lightbulb-fill me-2"></i>Field of Profession</label>
                                    {% if form.field_of_expertise.errors %}
                                        <div class="invalid-feedback">
                                            {{ form.field_of_expertise.errors.as_text }}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>

                        <hr class="my-4">

                        <h5 class="mb-4"><i class="bi bi-tools me-2"></i>Skills and Experience</h5>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <div class="form-floating">
                                    <select name="english_proficiency" class="form-select {% if form.english_proficiency.errors %}is-invalid{% endif %}" id="id_english_proficiency">
                                        {% for value, text in form.fields.english_proficiency.choices %}
                                            <option value="{{ value }}" {% if form.english_proficiency.value == value %}selected{% endif %}>{{ text }}</option>
                                        {% endfor %}
                                    </select>
                                    <label for="id_english_proficiency">English Proficiency</label>
                                    {% if form.english_proficiency.errors %}
                                        <div class="invalid-feedback">
                                            {{ form.english_proficiency.errors.as_text }}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="form-floating">
                                    <select name="web_search_proficiency" class="form-select {% if form.web_search_proficiency.errors %}is-invalid{% endif %}" id="id_web_search_proficiency">
                                        {% for value, text in form.fields.web_search_proficiency.choices %}
                                            <option value="{{ value }}" {% if form.web_search_proficiency.value == value %}selected{% endif %}>{{ text }}</option>
                                        {% endfor %}
                                    </select>
                                    <label for="id_web_search_proficiency">Web Search Proficiency</label>
                                    {% if form.web_search_proficiency.errors %}
                                        <div class="invalid-feedback">
                                            {{ form.web_search_proficiency.errors.as_text }}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>

                        <hr class="my-4">

                        <h5 class="mb-4"><i class="bi bi-robot me-2"></i>Large Language Model Usage</h5>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <div class="form-floating">
                                    <select name="llm_frequency" class="form-select {% if form.llm_frequency.errors %}is-invalid{% endif %}" id="id_llm_frequency">
                                        {% for value, text in form.fields.llm_frequency.choices %}
                                            <option value="{{ value }}" {% if form.llm_frequency.value == value %}selected{% endif %}>{{ text }}</option>
                                        {% endfor %}
                                    </select>
                                    <label for="id_llm_frequency">How often do you use LLMs?</label>
                                    {% if form.llm_frequency.errors %}
                                        <div class="invalid-feedback">
                                            {{ form.llm_frequency.errors.as_text }}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="form-floating">
                                    <select name="llm_history" class="form-select {% if form.llm_history.errors %}is-invalid{% endif %}" id="id_llm_history">
                                        {% for value, text in form.fields.llm_history.choices %}
                                            <option value="{{ value }}" {% if form.llm_history.value == value %}selected{% endif %}>{{ text }}</option>
                                        {% endfor %}
                                    </select>
                                    <label for="id_llm_history">How long have you been using LLMs?</label>
                                    {% if form.llm_history.errors %}
                                        <div class="invalid-feedback">
                                            {{ form.llm_history.errors.as_text }}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>

                        <hr class="my-4">

                        <h5 class="mb-4"><i class="bi bi-robot me-2"></i>Web Agent Usage <i class="bi bi-question-circle text-muted" data-bs-toggle="tooltip" data-bs-placement="top" title="Web agents are AI assistants that can autonomously browse websites and perform tasks for you."></i></h5>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <div class="form-floating">
                                    <select name="web_agent_familiarity" class="form-select {% if form.web_agent_familiarity.errors %}is-invalid{% endif %}" id="id_web_agent_familiarity">
                                        {% for value, text in form.fields.web_agent_familiarity.choices %}
                                            <option value="{{ value }}" {% if form.web_agent_familiarity.value == value %}selected{% endif %}>{{ text }}</option>
                                        {% endfor %}
                                    </select>
                                    <label for="id_web_agent_familiarity">How familiar are you with web agents?</label>
                                    {% if form.web_agent_familiarity.errors %}
                                        <div class="invalid-feedback">
                                            {{ form.web_agent_familiarity.errors.as_text }}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="form-floating">
                                    <select name="web_agent_frequency" class="form-select {% if form.web_agent_frequency.errors %}is-invalid{% endif %}" id="id_web_agent_frequency">
                                        {% for value, text in form.fields.web_agent_frequency.choices %}
                                            <option value="{{ value }}" {% if form.web_agent_frequency.value == value %}selected{% endif %}>{{ text }}</option>
                                        {% endfor %}
                                    </select>
                                    <label for="id_web_agent_frequency">How often do you use web agents?</label>
                                    {% if form.web_agent_frequency.errors %}
                                        <div class="invalid-feedback">
                                            {{ form.web_agent_frequency.errors.as_text }}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>

                        <div class="d-grid mt-4">
                            <button type="submit" class="btn btn-primary btn-lg"><i class="bi bi-person-plus-fill me-2"></i>Sign Up</button>
                        </div>
                    </form>
                </div>
                <div class="card-footer text-center py-3">
                    <div class="small"><a href="{% url 'user_system:login' %}" class="btn btn-link">Have an account? Go to login</a></div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const togglePassword = document.querySelector('#togglePassword');
    const password = document.querySelector('#id_password');

    togglePassword.addEventListener('click', function (e) {
        // toggle the type attribute
        const type = password.getAttribute('type') === 'password' ? 'text' : 'password';
        password.setAttribute('type', type);
        // toggle the eye / eye slash icon
        this.classList.toggle('bi-eye');
        this.classList.toggle('bi-eye-slash');
    });

    const togglePasswordRetype = document.querySelector('#togglePasswordRetype');
    const passwordRetype = document.querySelector('#id_password_retype');

    togglePasswordRetype.addEventListener('click', function (e) {
        // toggle the type attribute
        const type = passwordRetype.getAttribute('type') === 'password' ? 'text' : 'password';
        passwordRetype.setAttribute('type', type);
        // toggle the eye / eye slash icon
        this.classList.toggle('bi-eye');
        this.classList.toggle('bi-eye-slash');
    });
});
</script>
{% endblock %}